
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Server scenario &#8212; pyrfc 2.7.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/agogo.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Security" href="authentication.html" />
    <link rel="prev" title="Client scenario" href="client.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">pyrfc 2.7.0 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="client.html" title="Client scenario"
             accesskey="P">previous</a> |
          <a href="authentication.html" title="Security"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="server-scenario">
<span id="server"></span><h1>Server scenario<a class="headerlink" href="#server-scenario" title="Permalink to this heading">¶</a></h1>
<p>In <em>Server</em> scenario, ABAP system is calling Python remote enabled RFC server,
to consume Python functionality. Python functionality must be exposed like
an ABAP function module and Python server shall provide input / output parameters
just like ABAP function module.</p>
<p>To streamline that process, the real ABAP function module is used as a
“blueprint” and Python server will create exactly the same interface to
expose the functionality.</p>
<p>When Python server function “ABC” for example is registered on Python server,
the name of ABAP “blueprint” function module is given, where the input/output
parameters definition shall be taken from. The Python server function “ABC”
can therefore look like ABAP function module “XYZ” for example, using exactly  the same interface
like “XYZ”. The ABAP logic of “XYZ” is here irrelevant, the function module can
be empty. Already existing or new ABAP function module can be used here.</p>
<p>Python RFC server shall run in separate thread and that thread is either created
automatically, by PyRFC, or it can be created by Python application.</p>
<section id="examples">
<span id="server-ex"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<p>Here the PyRFC server is registered for ABAP system <code class="docutils literal notranslate"><span class="pre">gateway</span></code> and function modules’
“blueprint” definitions are read from ABAP system <code class="docutils literal notranslate"><span class="pre">MME</span></code>.</p>
<p>Python function <code class="docutils literal notranslate"><span class="pre">my_stfc_connection</span></code> is exposed as ABAP function <code class="docutils literal notranslate"><span class="pre">STFC_CONNECTION</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create server for ABAP system ABC</span>
<span class="n">server1</span> <span class="o">=</span> <span class="n">Server</span><span class="p">({</span><span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;gateway&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;MME&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">8081</span><span class="p">,</span> <span class="s2">&quot;server_log&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

<span class="c1"># expose python function my_stfc_connection as ABAP function STFC_CONNECTION, to be called by ABAP system</span>
<span class="n">server1</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="s2">&quot;STFC_CONNECTION&quot;</span><span class="p">,</span> <span class="n">my_stfc_connection</span><span class="p">)</span>
</pre></div>
</div>
<section id="server-in-thread-created-by-pyrfc">
<h3>Server in thread created by PyRFC<a class="headerlink" href="#server-in-thread-created-by-pyrfc" title="Permalink to this heading">¶</a></h3>
<p>Server running in new thread created by PyRFC is started using <code class="docutils literal notranslate"><span class="pre">start()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># start 1st server</span>
<span class="n">server1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># get server attributes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;server1&quot;</span><span class="p">,</span> <span class="n">server1</span><span class="o">.</span><span class="n">get_server_attributes</span><span class="p">())</span>
</pre></div>
</div>
<p>and can be stopped using <code class="docutils literal notranslate"><span class="pre">stop()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">server1</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server 1 stoped&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Example: <a class="reference external" href="https://github.com/SAP/PyRFC/blob/master/examples/server/start_stop.py">start_stop.py</a></p>
</section>
<section id="server-in-thread-created-by-application">
<h3>Server in thread created by application<a class="headerlink" href="#server-in-thread-created-by-application" title="Permalink to this heading">¶</a></h3>
<p>Server running in new thread created by application is started using
<code class="docutils literal notranslate"><span class="pre">serve()</span></code> method, like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">server1_thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">server1_serve</span><span class="p">)</span>
<span class="n">server1_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server1 started&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and stopped by application:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Press Enter to stop server1...&quot;</span><span class="p">)</span>

<span class="n">server1_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>
</div>
<p>Example: <a class="reference external" href="https://github.com/SAP/PyRFC/blob/master/examples/server/serve.py">start_stop.py</a></p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client scenario</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Server scenario</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="remarks.html">Remarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyrfc.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyrfc</span></code></a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </div>

        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="client.html" title="Client scenario"
              >previous</a> |
            <a href="authentication.html" title="Security"
              >next</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/server.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, SAP.
      Last updated on 2022-11-28 12:19.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>